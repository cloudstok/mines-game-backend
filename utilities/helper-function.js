import { variableConfig } from "./load-config.js";
import { createLogger } from "./logger.js";
const failedBetLogger = createLogger('failedBets', 'jsonl');
const failedPartialCashoutLogger = createLogger('failedPartialCashout', 'jsonl');
const failedCashoutLogger = createLogger('failedCashout', 'jsonl');
const failedGameLogger = createLogger('failedGame', 'jsonl');
export const logEventAndEmitResponse = (req, res, event, socket) => {
  let logData = JSON.stringify({ req, res })
  if (event === 'bet') {
    failedBetLogger.error(logData)
  }
  if (event === 'game') {
    failedGameLogger.error(logData)
  }
  if (event === 'cashout') {
    failedCashoutLogger.error(logData);
  }
  if (event === 'partialCashout') {
    failedPartialCashoutLogger.error(logData);
  }
  return socket.emit('betError', res);
}

export const generateGrid = (mineCount, boardSize) => {
  const size = boardSize || 5;
  const grid = Array.from({ length: size }, () =>
    Array.from({ length: size }, () => ({
      isMine: false,
      revealed: false,
    }))
  );

  let minesPlaced = 0;

  // Randomly place mines
  while (minesPlaced < mineCount) {
    const row = Math.floor(Math.random() * size);
    const col = Math.floor(Math.random() * size);

    if (!grid[row][col].isMine) {
      grid[row][col].isMine = true;
      minesPlaced++;
    }
  }

  return grid;
}

export const defaultData = {
  3: {
    1: ["1.07", "1.22", "1.43", "1.71", "2.14", "2.85", "4.28", "8.55"],
    2: ["1.22", "1.63", "2.28", "3.42", "5.7", "11.4", "34.2"],
    3: ["1.43", "2.28", "3.99", "7.98", "19.95", "79.8"],
    4: ["1.71", "3.42", "7.98", "23.94", "119.7"],
    5: ["2.14", "5.7", "19.95", "119.7"],
    6: ["2.85", "11.4", "79.8"],
    7: ["4.28", "34.2"],
    8: ["8.55"],
  },
  5: {
    1: [
      "0.99",
      "1.03",
      "1.08",
      "1.13",
      "1.19",
      "1.25",
      "1.32",
      "1.4",
      "1.48",
      "1.58",
      "1.7",
      "1.83",
      "1.98",
      "2.16",
      "2.38",
      "2.64",
      "2.97",
      "3.39",
      "3.96",
      "4.75",
      "5.94",
      "7.92",
      "11.88",
      "23.75",
    ],

    2: [
      "1.03",
      "1.13",
      "1.23",
      "1.36",
      "1.5",
      "1.67",
      "1.86",
      "2.1",
      "2.38",
      "2.71",
      "3.13",
      "3.65",
      "4.32",
      "5.18",
      "6.33",
      "7.92",
      "10.18",
      "13.57",
      "19",
      "28.5",
      "47.5",
      "95",
      "285",
    ],

    3: [
      "1.08",
      "1.23",
      "1.42",
      "1.64",
      "1.92",
      "2.25",
      "2.68",
      "3.21",
      "3.9",
      "4.8",
      "6",
      "7.64",
      "9.93",
      "13.24",
      "18.21",
      "26.01",
      "39.02",
      "62.43",
      "109.25",
      "218.5",
      "546.25",
      "2.18k",
    ],

    4: [
      "1.13",
      "1.36",
      "1.64",
      "2.01",
      "2.48",
      "3.1",
      "3.93",
      "5.05",
      "6.6",
      "8.8",
      "12.01",
      "16.81",
      "24.28",
      "36.42",
      "57.23",
      "95.38",
      "171.68",
      "343.36",
      "801.17",
      "2.4k",
      "12.01k",
    ],

    5: [
      "1.19",
      "1.5",
      "1.92",
      "2.48",
      "3.26",
      "4.34",
      "5.89",
      "8.16",
      "11.56",
      "16.81",
      "25.21",
      "39.22",
      "63.73",
      "109.25",
      "200.29",
      "400.58",
      "901.31",
      "2.4k",
      "8.41k",
      "50.47k",
    ],

    6: [
      "1.25",
      "1.67",
      "2.25",
      "3.1",
      "4.34",
      "6.2",
      "9.06",
      "13.59",
      "21.01",
      "33.62",
      "56.03",
      "98.04",
      "182.08",
      "364.17",
      "801.17",
      "2k",
      "6k",
      "24.03k",
      "168.24k",
    ],

    7: [
      "1.32",
      "1.86",
      "2.68",
      "3.93",
      "5.89",
      "9.06",
      "14.35",
      "23.48",
      "39.92",
      "70.97",
      "133.06",
      "266.12",
      "576.6",
      "1.38k",
      "3.8k",
      "12.68k",
      "57.08k",
      "456.66k",
    ],

    8: [
      "1.4",
      "2.1",
      "3.21",
      "5.05",
      "8.16",
      "13.59",
      "23.48",
      "42.27",
      "79.84",
      "159.67",
      "342.16",
      "798.37",
      "2.07k",
      "6.22k",
      "22.83k",
      "114.16k",
    ],

    9: [
      "1.48",
      "2.38",
      "3.9",
      "6.6",
      "11.56",
      "21.01",
      "39.92",
      "79.84",
      "169.65",
      "387.78",
      "969.44",
      "2.71k",
      "8.82k",
      "35.28k",
      "194.08k",
    ],

    10: [
      "1.58",
      "2.71",
      "4.8",
      "8.8",
      "16.81",
      "33.62",
      "70.97",
      "159.67",
      "387.78",
      "1.03k",
      "3.1k",
      "10.85k",
      "47.05k",
      "282.3k",
    ],

    11: [
      "1.7",
      "3.13",
      "6",
      "12.01",
      "25.21",
      "56.03",
      "133.06",
      "342.16",
      "969.44",
      "3.1k",
      "11.63k",
      "54.28k",
      "352.87k",
    ],

    12: [
      "1.83",
      "3.65",
      "7.64",
      "16.81",
      "39.22",
      "98.04",
      "266.12",
      "798.37",
      "2.71k",
      "10.85k",
      "54.28k",
      "380.02k",
    ],

    13: [
      "1.98",
      "4.32",
      "9.93",
      "24.28",
      "63.73",
      "182.08",
      "576.6",
      "2.07k",
      "8.82k",
      "47.05k",
      "352.87k",
    ],

    14: [
      "2.16",
      "5.18",
      "13.24",
      "36.42",
      "109.25",
      "364.17",
      "1.38k",
      "6.22k",
      "35.28k",
    ],

    15: [
      "2.38",
      "6.33",
      "18.21",
      "57.23",
      "200.29",
      "801.17",
      "3.8k",
      "22.83k",
      "194.08k",
    ],

    16: ["2.64", "7.92", "26.01", "95.38", "400.58", "2k", "12.68k", "114.16k"],

    17: ["2.97", "10.18", "39.02", "171.68", "901.31", "6k", "57.08k"],

    18: ["3.39", "13.57", "62.43", "343.36", "2.4k", "24.03k", "456.66k"],

    19: ["3.96", "19", "109.25", "801.17", "8.41k", "168.24k"],

    20: ["4.75", "28.5", "218.5", "2.4k", "50.47k"],

    21: ["5.94", "47.5", "546.25", "12.01k"],

    22: ["7.92", "95", "2.18k"],

    23: ["11.88", "285"],

    24: ["23.75"],
  },
  7: {
    1: [
      "0.97",
      "0.99",
      "1.01",
      "1.03",
      "1.06",
      "1.08",
      "1.11",
      "1.14",
      "1.16",
      "1.19",
      "1.23",
      "1.26",
      "1.29",
      "1.33",
      "1.37",
      "1.41",
      "1.45",
      "1.5",
      "1.55",
      "1.61",
      "1.66",
      "1.72",
      "1.79",
      "1.86",
      "1.94",
      "2.02",
      "2.12",
      "2.22",
      "2.33",
      "2.45",
      "2.59",
      "2.74",
      "2.91",
      "3.1",
      "3.33",
      "3.58",
      "3.88",
      "4.23",
      "4.65",
      "5.17",
      "5.82",
      "6.65",
      "7.76",
      "9.31",
      "11.64",
      "15.52",
      "23.28",
      "46.55",
    ],
    2: [
      "0.99",
      "1.03",
      "1.08",
      "1.13",
      "1.18",
      "1.24",
      "1.3",
      "1.36",
      "1.43",
      "1.51",
      "1.59",
      "1.68",
      "1.77",
      "1.88",
      "1.99",
      "2.12",
      "2.25",
      "2.4",
      "2.57",
      "2.75",
      "2.96",
      "3.18",
      "3.44",
      "3.72",
      "4.05",
      "4.42",
      "4.84",
      "5.32",
      "5.88",
      "6.53",
      "7.3",
      "8.21",
      "9.31",
      "10.64",
      "12.28",
      "14.32",
      "16.93",
      "20.31",
      "24.83",
      "31.03",
      "39.9",
      "53.2",
      "74.48",
      "111.72",
      "186.2",
      "372.4",
      "1.11k",
    ],
    3: [
      "1.01",
      "1.08",
      "1.15",
      "1.23",
      "1.32",
      "1.42",
      "1.52",
      "1.64",
      "1.77",
      "1.92",
      "2.07",
      "2.25",
      "2.45",
      "2.67",
      "2.92",
      "3.21",
      "3.53",
      "3.89",
      "4.31",
      "4.79",
      "5.34",
      "5.98",
      "6.73",
      "7.61",
      "8.65",
      "9.88",
      "11.37",
      "13.16",
      "15.35",
      "18.06",
      "21.45",
      "25.74",
      "31.26",
      "38.47",
      "48.08",
      "61.2",
      "79.56",
      "106.08",
      "145.86",
      "208.37",
      "312.55",
      "500.08",
      "875.14",
      "1.75k",
      "4.37k",
      "17.5k",
    ],

    4: [
      "1.03",
      "1.13",
      "1.23",
      "1.35",
      "1.48",
      "1.63",
      "1.8",
      "1.99",
      "2.2",
      "2.45",
      "2.73",
      "3.05",
      "3.42",
      "3.84",
      "4.34",
      "4.92",
      "5.6",
      "6.4",
      "7.34",
      "8.47",
      "9.83",
      "11.47",
      "13.46",
      "15.91",
      "18.94",
      "22.73",
      "27.52",
      "33.63",
      "41.54",
      "51.93",
      "65.78",
      "84.57",
      "110.59",
      "147.46",
      "201.08",
      "281.51",
      "406.63",
      "609.95",
      "958.49",
      "1.59k",
      "2.87k",
      "5.75k",
      "13.41k",
      "40.25k",
      "201.28k",
    ],

    5: [
      "1.06",
      "1.18",
      "1.32",
      "1.48",
      "1.67",
      "1.88",
      "2.13",
      "2.42",
      "2.75",
      "3.15",
      "3.61",
      "4.16",
      "4.81",
      "5.58",
      "6.51",
      "7.63",
      "9",
      "10.66",
      "12.71",
      "15.25",
      "18.43",
      "22.44",
      "27.54",
      "34.1",
      "42.62",
      "53.84",
      "68.79",
      "89.02",
      "116.84",
      "155.79",
      "211.43",
      "292.75",
      "414.73",
      "603.24",
      "904.87",
      "1.4k",
      "2.28k",
      "3.92k",
      "7.18k",
      "14.37k",
      "32.34k",
      "86.26k",
      "301.92k",
    ],

    6: [
      "1.08",
      "1.24",
      "1.42",
      "1.63",
      "1.88",
      "2.18",
      "2.53",
      "2.95",
      "3.46",
      "4.07",
      "4.81",
      "5.71",
      "6.82",
      "8.18",
      "9.88",
      "11.99",
      "14.66",
      "18.04",
      "22.37",
      "27.97",
      "35.26",
      "44.88",
      "57.7",
      "75.01",
      "98.7",
      "131.6",
      "178.05",
      "244.81",
      "342.74",
      "489.63",
      "715.61",
      "1.07k",
      "1.65k",
      "2.65k",
      "4.42k",
      "7.74k",
      "14.37k",
      "28.75k",
      "63.26k",
      "158.15k",
      "474.45k",
    ],

    7: [
      "1.11",
      "1.3",
      "1.52",
      "1.8",
      "2.13",
      "2.53",
      "3.02",
      "3.63",
      "4.38",
      "5.31",
      "6.47",
      "7.93",
      "9.78",
      "12.14",
      "15.17",
      "19.1",
      "24.25",
      "31.03",
      "40.09",
      "52.29",
      "68.92",
      "91.9",
      "124.06",
      "169.76",
      "235.78",
      "332.87",
      "478.5",
      "701.8",
      "1.05k",
      "1.61k",
      "2.56k",
      "4.19k",
      "7.13k",
      "12.68k",
      "23.77k",
      "47.55k",
      "103.03k",
      "247.28k",
      "680.04k",
    ],

    8: [
      "1.14",
      "1.36",
      "1.64",
      "1.99",
      "2.42",
      "2.95",
      "3.63",
      "4.48",
      "5.57",
      "6.96",
      "8.76",
      "11.1",
      "14.16",
      "18.2",
      "23.6",
      "30.86",
      "40.73",
      "54.31",
      "73.2",
      "99.82",
      "137.84",
      "192.98",
      "274.23",
      "396.12",
      "582.52",
      "873.79",
      "1.33k",
      "2.1k",
      "3.4k",
      "5.66k",
      "9.79k",
      "17.62k",
      "33.28k",
      "66.57k",
      "142.66k",
      "332.88k",
    ],

    9: [
      "1.16",
      "1.43",
      "1.77",
      "2.2",
      "2.75",
      "3.46",
      "4.38",
      "5.57",
      "7.14",
      "9.21",
      "11.97",
      "15.69",
      "20.73",
      "27.64",
      "37.21",
      "50.61",
      "69.58",
      "96.81",
      "136.42",
      "194.88",
      "282.58",
      "416.43",
      "624.64",
      "955.34",
      "1.49k",
      "2.38k",
      "3.92k",
      "6.64k",
      "11.62k",
      "21.12k",
      "40.14k",
      "80.28k",
      "170.6k",
      "389.95k",
    ],

    10: [
      "1.19",
      "1.51",
      "1.92",
      "2.45",
      "3.15",
      "4.07",
      "5.31",
      "6.96",
      "9.21",
      "12.28",
      "16.51",
      "22.41",
      "30.71",
      "42.53",
      "59.54",
      "84.34",
      "121.01",
      "176.02",
      "259.84",
      "389.76",
      "594.9",
      "925.4",
      "1.46k",
      "2.38k",
      "3.98k",
      "6.82k",
      "12.07k",
      "22.13k",
      "42.25k",
      "84.51k",
      "178.41k",
      "401.42k",
    ],
    11: [
      "1.23",
      "1.59",
      "2.07",
      "2.73",
      "3.61",
      "4.81",
      "6.47",
      "8.76",
      "11.97",
      "16.51",
      "23",
      "32.37",
      "46.07",
      "66.34",
      "96.75",
      "143.02",
      "214.53",
      "326.9",
      "506.69",
      "800.04",
      "1.28k",
      "2.12k",
      "3.58k",
      "6.2k",
      "11.08k",
      "20.47k",
      "39.23k",
      "78.47k",
      "164.79k",
      "366.21k",
    ],

    12: [
      "1.26",
      "1.68",
      "2.25",
      "3.05",
      "4.16",
      "5.71",
      "7.93",
      "11.1",
      "15.69",
      "22.41",
      "32.37",
      "47.32",
      "70.03",
      "105.04",
      "159.84",
      "247.03",
      "388.19",
      "621.1",
      "1.01k",
      "1.68k",
      "2.88k",
      "5.04k",
      "9.07k",
      "16.85k",
      "32.41k",
      "64.82k",
      "135.54k",
      "298.2k",
      "695.8k",
    ],

    13: [
      "1.29",
      "1.77",
      "2.45",
      "3.42",
      "4.81",
      "6.82",
      "9.78",
      "14.16",
      "20.73",
      "30.71",
      "46.07",
      "70.03",
      "107.96",
      "168.98",
      "268.83",
      "435.24",
      "718.15",
      "1.2k",
      "2.08k",
      "3.67k",
      "6.66k",
      "12.43k",
      "23.98k",
      "47.97k",
      "99.94k",
      "218.05k",
      "501.52k",
    ],

    14: [
      "1.33",
      "1.88",
      "2.67",
      "3.84",
      "5.58",
      "8.18",
      "12.14",
      "18.2",
      "27.64",
      "42.53",
      "66.34",
      "105.04",
      "168.98",
      "276.51",
      "460.85",
      "783.44",
      "1.36k",
      "2.41k",
      "4.41k",
      "8.27k",
      "15.99k",
      "31.98k",
      "66.42k",
      "143.91k",
      "327.07k",
      "784.99k",
    ],

    15: [
      "1.37",
      "1.99",
      "2.92",
      "4.34",
      "6.51",
      "9.88",
      "15.17",
      "23.6",
      "37.21",
      "59.54",
      "96.75",
      "159.84",
      "268.83",
      "460.85",
      "806.48",
      "1.44k",
      "2.64k",
      "4.98k",
      "9.64k",
      "19.29k",
      "39.97k",
      "86.1k",
      "193.73k",
      "457.91k",
    ],

    16: [
      "1.41",
      "2.12",
      "3.21",
      "4.92",
      "7.63",
      "11.99",
      "19.1",
      "30.86",
      "50.61",
      "84.34",
      "143.02",
      "247.03",
      "435.24",
      "783.44",
      "1.44k",
      "2.72k",
      "5.29k",
      "10.58k",
      "21.87k",
      "46.86k",
      "104.55k",
      "243.95k",
      "598.8k",
    ],

    17: [
      "1.45",
      "2.25",
      "3.53",
      "5.6",
      "9",
      "14.66",
      "24.25",
      "40.73",
      "69.58",
      "121.01",
      "214.53",
      "388.19",
      "718.15",
      "1.36k",
      "2.64k",
      "5.29k",
      "10.91k",
      "23.28k",
      "51.55k",
      "118.97k",
      "287.52k",
      "731.87k",
    ],

    18: [
      "1.5",
      "2.4",
      "3.89",
      "6.4",
      "10.66",
      "18.04",
      "31.03",
      "54.31",
      "96.81",
      "176.02",
      "326.9",
      "621.1",
      "1.2k",
      "2.41k",
      "4.98k",
      "10.58k",
      "23.28k",
      "53.21k",
      "126.9k",
      "317.26k",
    ],

    19: [
      "1.55",
      "2.57",
      "4.31",
      "7.34",
      "12.71",
      "22.37",
      "40.09",
      "73.2",
      "136.42",
      "259.84",
      "506.69",
      "1.01k",
      "2.08k",
      "4.41k",
      "9.64k",
      "21.87k",
      "51.55k",
      "126.9k",
      "327.84k",
    ],

    20: [
      "1.61",
      "2.75",
      "4.79",
      "8.47",
      "15.25",
      "27.97",
      "52.29",
      "99.82",
      "194.88",
      "389.76",
      "800.04",
      "1.68k",
      "3.67k",
      "8.27k",
      "19.29k",
      "46.86k",
      "118.97k",
      "317.26k",
    ],

    21: [
      "1.66",
      "2.96",
      "5.34",
      "9.83",
      "18.43",
      "35.26",
      "68.92",
      "137.84",
      "282.58",
      "594.9",
      "1.28k",
      "2.88k",
      "6.66k",
      "15.99k",
      "39.97k",
      "104.55k",
      "287.52k",
    ],

    22: [
      "1.72",
      "3.18",
      "5.98",
      "11.47",
      "22.44",
      "44.88",
      "91.9",
      "192.98",
      "416.43",
      "925.4",
      "2.12k",
      "5.04k",
      "12.43k",
      "31.98k",
      "86.1k",
      "243.95k",
      "731.87k",
    ],

    23: [
      "1.79",
      "3.44",
      "6.73",
      "13.46",
      "27.54",
      "57.7",
      "124.06",
      "274.23",
      "624.64",
      "1.46k",
      "3.58k",
      "9.07k",
      "23.98k",
      "66.42k",
      "193.73k",
      "598.8k",
    ],

    24: [
      "1.86",
      "3.72",
      "7.61",
      "15.91",
      "34.1",
      "75.01",
      "169.76",
      "396.12",
      "955.34",
      "2.38k",
      "6.2k",
      "16.85k",
      "47.97k",
      "143.91k",
      "457.91k",
    ],

    25: [
      "1.94",
      "4.05",
      "8.65",
      "18.94",
      "42.62",
      "98.7",
      "235.78",
      "582.52",
      "1.49k",
      "3.98k",
      "11.08k",
      "32.41k",
      "99.94k",
      "327.07k",
    ],

    26: [
      "2.02",
      "4.42",
      "9.88",
      "22.73",
      "53.84",
      "131.6",
      "332.87",
      "873.79",
      "2.38k",
      "6.82k",
      "20.47k",
      "64.82k",
      "218.05k",
      "784.99k",
    ],

    27: [
      "2.12",
      "4.84",
      "11.37",
      "27.52",
      "68.79",
      "178.05",
      "478.5",
      "1.33k",
      "3.92k",
      "12.07k",
      "39.23k",
      "135.54k",
      "501.52k",
    ],

    28: [
      "2.22",
      "5.32",
      "13.16",
      "33.63",
      "89.02",
      "244.81",
      "701.8",
      "2.1k",
      "6.64k",
      "22.13k",
      "78.47k",
      "298.2k",
    ],

    29: [
      "2.33",
      "5.88",
      "15.35",
      "41.54",
      "116.84",
      "342.74",
      "1.05k",
      "3.4k",
      "11.62k",
      "42.25k",
      "164.79k",
      "695.8k",
    ],

    30: [
      "2.45",
      "6.53",
      "18.06",
      "51.93",
      "155.79",
      "489.63",
      "1.61k",
      "5.66k",
      "21.12k",
      "84.51k",
      "366.21k",
    ],

    31: [
      "2.59",
      "7.3",
      "21.45",
      "65.78",
      "211.43",
      "715.61",
      "2.56k",
      "9.79k",
      "40.14k",
      "178.41k",
    ],

    32: [
      "2.74",
      "8.21",
      "25.74",
      "84.57",
      "292.75",
      "1.07k",
      "4.19k",
      "17.62k",
      "80.28k",
      "401.42k",
    ],

    33: [
      "2.91",
      "9.31",
      "31.26",
      "110.59",
      "414.73",
      "1.65k",
      "7.13k",
      "33.28k",
      "170.6k",
    ],

    34: [
      "3.1",
      "10.64",
      "38.47",
      "147.46",
      "603.24",
      "2.65k",
      "12.68k",
      "66.57k",
      "389.95k",
    ],

    35: [
      "3.33",
      "12.28",
      "48.08",
      "201.08",
      "904.87",
      "4.42k",
      "23.77k",
      "142.66k",
    ],

    36: [
      "3.58",
      "14.32",
      "61.2",
      "281.51",
      "1.4k",
      "7.74k",
      "47.55k",
      "332.88k",
    ],

    37: ["3.88", "16.93", "79.56", "406.63", "2.28k", "14.37k", "103.03k"],

    38: ["4.23", "20.31", "106.08", "609.95", "3.92k", "28.75k", "247.28k"],

    39: ["4.66", "24.83", "145.86", "958.49", "7.18k", "63.26k", "680.04k"],

    40: ["5.17", "31.03", "208.37", "1.59k", "14.37k", "158.15k"],

    41: ["5.82", "39.9", "312.55", "2.87k", "32.34k", "474.45k"],

    42: ["6.65", "53.2", "500.08", "5.75k", "86.26k"],

    43: ["7.76", "74.48", "875.14", "13.41k", "301.92k"],

    44: ["9.31", "111.72", "1.75k", "40.25k"],

    45: ["11.64", "186.2", "4.37k", "201.28k"],

    46: ["15.52", "372.4", "17.5k"],

    47: ["23.28", "1.11k"],

    48: ["46.55"],
  },
};

export const MinesData = (mineCount ="3" , boardSize ="5") => {
  const data = variableConfig.mineData ? JSON.parse(JSON.stringify(variableConfig.mineData))[boardSize][mineCount] : defaultData[boardSize][mineCount];
  return data;
};

export const  getNextMultiplier = (mineCount= "3", boardSize = "5", index) => {
  const minesData = MinesData(mineCount , boardSize);
  return convertKValue(minesData[index]);
  // return minesData[boardSize][mineCount][index];
}

function convertKValue(i){
  if(i.includes('k')){
       i = i.replace('k', '');
       i = `${Number(i) * 1000}`
  };
  return i
}

export const countMinesAndRevealed = (grid)=> {

  let count = 0;
  for (let row of grid) {
    for (let cell of row) {
      if (cell.isMine || cell.revealed) {
        count++;
      }
    }
  }
  return count;
}

export const getRandomRowCol = (playerGrids) => {
  const unrevealedCells = [];
  for (let row = 0; row < playerGrids.length; row++) {
    for (let col = 0; col < playerGrids[row].length; col++) {
      if (!playerGrids[row][col].revealed) {
        unrevealedCells.push({ row, col });
      }
    }
  }

  return unrevealedCells[Math.floor(Math.random() * unrevealedCells.length)];
}